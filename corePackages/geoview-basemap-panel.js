/*! Package:geoview-basemap-panel: 0.1.0 - "d2580f9f2c770d7fecdba2ee89155460ee9b8384" - 2023-08-24T14:57:00.815Z */
(self.webpackChunkgeoview_core=self.webpackChunkgeoview_core||[]).push([[286],{47341:(e,a,t)=>{"use strict";var r=t(18211),n=t(65151),o=t(35533),s=t(51487),i=t(7393),p=t(19316),l=t(41124),c=t(79712),d=t(26200),u=t(29039),m=t(20703),b=t(78838),f=t.n(b),h=t(76696),g=t.n(h),v=t(39882),y=t(29541),j=window;function C(e){var a=e.mapId,t=e.config,r=j.cgpv,n=r.ui,o=r.react,s=r.api,i=s.map(a),p=n.elements,l=p.Select,b=p.Card,h=o.useState,C=o.useEffect,P=h([]),x=(0,m.Z)(P,2),I=x[0],w=x[1],B=h(""),Z=(0,m.Z)(B,2),k=Z[0],N=Z[1],O=h(t.canSwichProjection),A=(0,m.Z)(O,1)[0],S=n.makeStyles((function(e){return{basemapCard:{backgroundColor:e.palette.grey.A700,color:e.palette.primary.light,display:"flex",flexDirection:"column",backgroundClip:"padding-box",border:"1px solid ".concat(e.basemapPanel.borderDefault),borderRadius:6,boxShadow:"none",marginBottom:16,transition:"all 0.3s ease-in-out","&:last-child":{marginBottom:0},"& .MuiCardHeader-root":{backgroundColor:e.palette.grey.A700,color:e.basemapPanel.header,fontSize:14,fontWeight:400,margin:0,padding:"0 12px",height:60,width:"100%",order:2},"& .MuiCardContent-root":{order:1,height:190,position:"relative",padding:0,"&:last-child":{padding:0},"& .basemapCardThumbnail":{position:"absolute",height:"100%",width:"100%",objectFit:"cover",top:0,left:0},"& .basemapCardThumbnailOverlay":{display:"block",height:"100%",width:"100%",position:"absolute",backgroundColor:e.basemapPanel.overlayDefault,transition:"all 0.3s ease-in-out"}},"&:hover":{cursor:"pointer",borderColor:e.basemapPanel.borderHover,"& .MuiCardContent-root":{"& .basemapCardThumbnailOverlay":{backgroundColor:e.basemapPanel.overlayHover}}},"&.active":{borderColor:e.basemapPanel.borderActive,"& .MuiCardContent-root":{"& .basemapCardThumbnailOverlay":{backgroundColor:e.basemapPanel.overlayActive}},"&:hover":{borderColor:"rgba(255,255,255,0.75)","& .MuiCardContent-root":{"& .basemapCardThumbnailOverlay":{backgroundColor:"rgba(0,0,0,0)"}}}}}}}))(),T=t.supportedProjections.map((function(e){return null==e?void 0:e.projectionCode}))||[],_=h(i.mapFeaturesConfig.map.viewSettings.projection),L=(0,m.Z)(_,2),M=L[0],$=L[1],q=function(e){i.basemap.setBasemap(e),N(e)},U=function(){var e=(0,u.Z)(g().mark((function e(a){var r,n,o,s,p,l,u,m;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=(0,c.ZQJ)(t.supportedProjections.find((function(e){return e.projectionCode===a}))),n=!1,i.basemap.basemaps=[],w([]),o=i.mapFeaturesConfig.map.basemapOptions,e.next=7,i.basemap.createCoreBasemap(o,a);case 7:(s=e.sent)&&w([s]),p=g().mark((function e(){var a,t;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:f()(r.customBasemaps[l],o)||(a=r.customBasemaps[l],(t=i.basemap.createCustomBasemap(a))&&w((function(e){return[].concat((0,d.Z)(e),[t])})),t&&0===l&&""===k&&(q(t.basemapId),n=!0));case 1:case"end":return e.stop()}}),e)})),l=0;case 11:if(!(l<r.customBasemaps.length)){e.next=16;break}return e.delegateYield(p(),"t0",13);case 13:l++,e.next=11;break;case 16:u=g().mark((function e(){var t,s,p;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(f()(r.coreBasemaps[m],o)){e.next=8;break}return t=r.coreBasemaps[m],e.next=4,i.basemap.createCoreBasemap(t,a);case 4:(s=e.sent)&&w((function(e){return[].concat((0,d.Z)(e),[s])})),p="".concat(t.shaded?"shaded":"").concat(t.id).concat(t.labeled?"label":""),s&&p===k&&!n&&(q(k),n=!0);case 8:case"end":return e.stop()}}),e)})),m=0;case 18:if(!(m<r.coreBasemaps.length)){e.next=23;break}return e.delegateYield(u(),"t1",20);case 20:m++,e.next=18;break;case 23:n||q(i.basemap.basemaps[0].basemapId);case 24:case"end":return e.stop()}}),e)})));return function(a){return e.apply(this,arguments)}}();return C((function(){U(M)}),[]),(0,y.jsxs)("div",{children:[A&&(0,y.jsx)(l,{fullWidth:!0,labelId:"projection-label",value:M,onChange:function(e){var t=e.target.value;q("nogeom"),$(t);var r=i.getView(),n=r.getCenter(),o=r.getProjection().getCode(),p=s.projection.transformPoints(n,o,"EPSG:4326")[0],l=e.target.value,c={zoom:r.getZoom(),minZoom:r.getMinZoom(),maxZoom:r.getMaxZoom(),center:p,projection:l};i.setView(c),U(t),s.event.emit((0,v.lt)(s.eventNames.MAP.EVENT_MAP_VIEW_PROJECTION_CHANGE,a,t))},label:"Projection",style:{display:t.canSwichProjection?"flex":"none"},inputLabel:{id:"projection-label"},menuItems:T.map((function(e){return{key:e,item:{value:e,children:"EPSG:".concat(e)}}}))}),I.map((function(e){return(0,y.jsx)(b,{tabIndex:0,classes:{root:S.basemapCard},className:e.basemapId===k?"active":"",onClick:function(){return q(e.basemapId)},onKeyPress:function(){return q(e.basemapId)},title:e.name,contentCard:(0,y.jsxs)(y.Fragment,{children:["string"==typeof e.thumbnailUrl&&(0,y.jsx)("img",{src:e.thumbnailUrl,alt:e.altText,className:"basemapCardThumbnail"}),Array.isArray(e.thumbnailUrl)&&e.thumbnailUrl.map((function(a,t){return(0,y.jsx)("img",{src:a,alt:e.altText,className:"basemapCardThumbnail"},t)})),(0,y.jsx)("div",{className:"basemapCardThumbnailOverlay"})]})},e.basemapId)}))]})}const P=JSON.parse('{"$schema":"http://json-schema.org/draft-07/schema#","title":"GeoView Basemap Panel Schema","type":"object","version":1,"comments":"Configuration for GeoView basemap panel package.","additionalProperties":false,"definitions":{"basemapNameNode":{"type":"object","properties":{"en":{"type":"string"},"fr":{"type":"string"}},"description":"The display name of the layer."},"basemapDescriptionNode":{"type":"object","properties":{"en":{"type":"string"},"fr":{"type":"string"}},"description":"Basemap description."},"thumbnailUrlNode":{"type":"object","properties":{"en":{"type":"array","uniqueItems":true,"items":{"type":"string"}},"fr":{"type":"array","uniqueItems":true,"items":{"type":"string"}}},"description":"Basemap thumbnail urls."},"basemapLayerUrlNode":{"type":"object","properties":{"en":{"type":"string"},"fr":{"type":"string"}},"description":"The service endpoint of the basemap layer."},"basemapAttributionNode":{"type":"object","properties":{"en":{"type":"string"},"fr":{"type":"string"}},"description":"Basemap attribution text."},"basemapLayersNode":{"type":"object","properties":{"basemapId":{"type":"string","description":"the id of the basmap layer."},"url":{"$ref":"#/definitions/basemapLayerUrlNode"},"opacity":{"type":"number","description":"the opacity of this layer.","default":0}},"additionalItems":false,"required":["basemapId","url"]},"basemap":{"type":"object","properties":{"basemapId":{"type":"string","description":"the basemap id","enum":["transport","simple","shaded","osm","nogeom"]},"shaded":{"type":"boolean","description":"if a shaded layer should be included with this basemap.","default":false},"labeled":{"type":"boolean","description":"if labels should be enabled in this basemap.","default":false}},"additionalProperties":false,"required":["basemapId","shaded","labeled"]},"customBasemap":{"type":"object","properties":{"basemapId":{"type":"string","description":"the basemap id."},"name":{"$ref":"#/definitions/basemapNameNode"},"description":{"$ref":"#/definitions/basemapDescriptionNode"},"thumbnailUrl":{"$ref":"#/definitions/thumbnailUrlNode"},"layers":{"type":"array","description":"a list of basemap layers","items":{"$ref":"#/definitions/basemapLayersNode"},"minItems":1},"attribution":{"$ref":"#/definitions/basemapAttributionNode"},"zoomLevels":{"type":"object","description":"Zoom levels for the basemap","properties":{"min":{"type":"integer","minimum":0,"maximum":24,"default":0},"max":{"type":"integer","minimum":0,"maximum":24,"default":24}},"additionalProperties":false,"required":["min","max"]}},"additionalProperties":false,"required":["basemapId","name","description","layers"]}},"properties":{"isOpen":{"type":"boolean","description":"Specifies whether the basemap panel is initially open or closed","default":false},"canSwichProjection":{"type":"boolean","description":"Allow the user to switch projection from the basemap panel.","default":true},"supportedProjections":{"type":"array","items":{"type":"object","properties":{"projectionCode":{"type":"integer","enum":[3978,3857],"description":"Default projection to load on start."},"customBasemaps":{"type":"array","description":"A list of custom basemaps.","items":{"$ref":"#/definitions/customBasemap"},"minItems":0},"coreBasemaps":{"type":"array","description":"A list of basemaps available in the core to show in the panel.","items":{"$ref":"#/definitions/basemap"},"minItems":1}}},"minItems":1,"required":["coreBasemaps","customBasemaps"]},"suportedLanguages":{"type":"array","uniqueItems":true,"items":{"type":"string","enum":["en","fr"]},"default":["en","fr"],"description":"ISO 639-1 code indicating the languages supported by the configuration file.","minItems":1},"version":{"type":"string","enum":["1.0"],"description":"The schema version used to validate the configuration file. The schema should enumerate the list of versions accepted by this version of the viewer."}},"required":["canSwichProjection","supportedProjections","suportedLanguages"]}'),x=JSON.parse('{"isOpen":false,"canSwichProjection":false,"supportedProjections":[{"projectionCode":3978,"coreBasemaps":[{"basemapId":"transport","shaded":true,"labeled":true},{"basemapId":"transport","shaded":true,"labeled":false},{"basemapId":"osm","shaded":true,"labeled":false},{"basemapId":"simple","shaded":true,"labeled":false},{"basemapId":"shaded","shaded":true,"labeled":false},{"basemapId":"nogeom","shaded":false,"labeled":false}],"customBasemaps":[]},{"projectionCode":3857,"coreBasemaps":[{"basemapId":"transport","shaded":true,"labeled":true},{"basemapId":"transport","shaded":true,"labeled":false},{"basemapId":"osm","shaded":true,"labeled":false},{"basemapId":"simple","shaded":true,"labeled":false},{"basemapId":"shaded","shaded":true,"labeled":false},{"basemapId":"nogeom","shaded":false,"labeled":false}],"customBasemaps":[]}],"suportedLanguages":["en","fr"]}');function I(e){var a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var t,r=(0,p.Z)(e);if(a){var n=(0,p.Z)(this).constructor;t=Reflect.construct(r,arguments,n)}else t=r.apply(this,arguments);return(0,i.Z)(this,t)}}var w=window,B=function(e){(0,s.Z)(t,e);var a=I(t);function t(e,n){var s;return(0,r.Z)(this,t),s=a.call(this,e,n),(0,l.Z)((0,o.Z)(s),"schema",(function(){return P})),(0,l.Z)((0,o.Z)(s),"defaultConfig",(function(){return(0,c.ZQJ)(x)})),(0,l.Z)((0,o.Z)(s),"translations",(0,c.ZQJ)({en:{basemapPanel:"Basemaps"},fr:{basemapPanel:"Fond de carte"}})),(0,l.Z)((0,o.Z)(s),"added",(function(){var e=(0,o.Z)(s),a=e.configObj,t=e.pluginProps.mapId,r=w.cgpv;if(r){var n,i=r.api,p=r.ui.elements.MapIcon,l=i.map(t).displayLanguage,c={id:"basemapPanelButton",tooltip:s.translations[l].basemapPanel,tooltipPlacement:"right",children:(0,y.jsx)(p,{}),visible:!0},d={title:s.translations[l].basemapPanel,icon:'<i class="material-icons">map</i>',width:350,status:null==a?void 0:a.isOpen};s.buttonPanel=i.map(t).appBarButtons.createAppbarPanel(c,d,null),null===(n=s.buttonPanel)||void 0===n||null===(n=n.panel)||void 0===n||n.changeContent((0,y.jsx)(C,{mapId:t,config:a||{}}))}})),s.buttonPanel=null,s}return(0,n.Z)(t,[{key:"removed",value:function(){var e=this.pluginProps.mapId,a=w.cgpv;if(a){var t=a.api;this.buttonPanel&&(t.map(e).appBarButtons.removeAppbarPanel(this.buttonPanel.buttonPanelId),t.map(e).basemap.basemaps=[],t.map(e).basemap.loadDefaultBasemaps())}}}]),t}(c.Vw$);w.plugins=w.plugins||{},w.plugins["basemap-panel"]=(0,c.RFZ)(B)},37655:(e,a,t)=>{var r=t(44490);e.exports=function(){if(!arguments.length)return[];var e=arguments[0];return r(e)?e:[e]}},55733:e=>{e.exports=function(e,a){for(var t=-1,r=null==e?0:e.length;++t<r;)if(a(e[t],t,e))return!0;return!1}},27283:(e,a,t)=>{var r=t(7626),n=t(4394);e.exports=function e(a,t,o,s,i){return a===t||(null==a||null==t||!n(a)&&!n(t)?a!=a&&t!=t:r(a,t,o,s,e,i))}},7626:(e,a,t)=>{var r=t(82160),n=t(68288),o=t(84697),s=t(40194),i=t(44305),p=t(44490),l=t(34772),c=t(10345),d="[object Arguments]",u="[object Array]",m="[object Object]",b=Object.prototype.hasOwnProperty;e.exports=function(e,a,t,f,h,g){var v=p(e),y=p(a),j=v?u:i(e),C=y?u:i(a),P=(j=j==d?m:j)==m,x=(C=C==d?m:C)==m,I=j==C;if(I&&l(e)){if(!l(a))return!1;v=!0,P=!1}if(I&&!P)return g||(g=new r),v||c(e)?n(e,a,t,f,h,g):o(e,a,j,t,f,h,g);if(!(1&t)){var w=P&&b.call(e,"__wrapped__"),B=x&&b.call(a,"__wrapped__");if(w||B){var Z=w?e.value():e,k=B?a.value():a;return g||(g=new r),h(Z,k,t,f,g)}}return!!I&&(g||(g=new r),s(e,a,t,f,h,g))}},86806:(e,a,t)=>{var r=t(57549);e.exports=function(e,a){return!!(null==e?0:e.length)&&r(e,a,0)>-1}},68288:(e,a,t)=>{var r=t(37655),n=t(55733),o=t(86806);e.exports=function(e,a,t,s,i,p){var l=1&t,c=e.length,d=a.length;if(c!=d&&!(l&&d>c))return!1;var u=p.get(e),m=p.get(a);if(u&&m)return u==a&&m==e;var b=-1,f=!0,h=2&t?new r:void 0;for(p.set(e,a),p.set(a,e);++b<c;){var g=e[b],v=a[b];if(s)var y=l?s(v,g,b,a,e,p):s(g,v,b,e,a,p);if(void 0!==y){if(y)continue;f=!1;break}if(h){if(!n(a,(function(e,a){if(!o(h,a)&&(g===e||i(g,e,t,s,p)))return h.push(a)}))){f=!1;break}}else if(g!==v&&!i(g,v,t,s,p)){f=!1;break}}return p.delete(e),p.delete(a),f}},84697:e=>{e.exports=function(e,a){return e===a||e!=e&&a!=a}},40194:(e,a,t)=>{var r=t(77935),n=Object.prototype.hasOwnProperty;e.exports=function(e,a,t,o,s,i){var p=1&t,l=r(e),c=l.length;if(c!=r(a).length&&!p)return!1;for(var d=c;d--;){var u=l[d];if(!(p?u in a:n.call(a,u)))return!1}var m=i.get(e),b=i.get(a);if(m&&b)return m==a&&b==e;var f=!0;i.set(e,a),i.set(a,e);for(var h=p;++d<c;){var g=e[u=l[d]],v=a[u];if(o)var y=p?o(v,g,u,a,e,i):o(g,v,u,e,a,i);if(!(void 0===y?g===v||s(g,v,t,o,i):y)){f=!1;break}h||(h="constructor"==u)}if(f&&!h){var j=e.constructor,C=a.constructor;j==C||!("constructor"in e)||!("constructor"in a)||"function"==typeof j&&j instanceof j&&"function"==typeof C&&C instanceof C||(f=!1)}return i.delete(e),i.delete(a),f}},78838:(e,a,t)=>{var r=t(27283);e.exports=function(e,a){return r(e,a)}}},e=>{var a;a=47341,e(e.s=a)}]);
//# sourceMappingURL=geoview-basemap-panel.js.map