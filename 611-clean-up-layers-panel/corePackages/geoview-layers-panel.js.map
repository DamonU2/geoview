{"version":3,"file":"corePackages/geoview-layers-panel.js","mappings":"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","sources":["webpack://geoview-core/../geoview-layers-panel/src/layer-stepper.tsx","webpack://geoview-core/../geoview-layers-panel/src/panel-content.tsx","webpack://geoview-core/../geoview-layers-panel/src/index.tsx"],"sourcesContent":["/* eslint-disable react/require-default-props */\nimport {\n  TypeWindow,\n  TypeJsonArray,\n  TypeEsriDynamicLayerEntryConfig,\n  TypeWmsLayerEntryConfig,\n  TypeGeoviewLayerConfig,\n  TypeGeoviewLayerType,\n  SelectChangeEvent,\n  snackbarMessagePayload,\n  ButtonPropsLayerPanel,\n  TypeListOfLayerEntryConfig,\n  TypeJsonObject,\n} from 'geoview-core';\n\ntype Event = { target: { value: string } };\n\ninterface Props {\n  mapId: string;\n  setAddLayerVisible: (isVisible: boolean) => void;\n}\n\ntype EsriOptions = {\n  err: string;\n  capability: string;\n};\n\nconst w = window as TypeWindow;\n\n/**\n * A react component that displays the details panel content\n *\n * @returns {JSX.Element} A React JSX Element with the details panel\n */\nfunction LayerStepper({ mapId, setAddLayerVisible }: Props): JSX.Element {\n  const { cgpv } = w;\n  const { api, react, ui } = cgpv;\n\n  const { ESRI_DYNAMIC, ESRI_FEATURE, GEOJSON, WMS, WFS, OGC_FEATURE, XYZ_TILES, GEOCORE } = api.layerTypes;\n  const { useState } = react;\n  const { Select, Stepper, TextField, Button, ButtonGroup, Autocomplete } = ui.elements;\n\n  const [activeStep, setActiveStep] = useState(0);\n  const [layerURL, setLayerURL] = useState('');\n  const [layerType, setLayerType] = useState<TypeGeoviewLayerType | ''>('');\n  const [layerList, setLayerList] = useState<TypeJsonArray[]>([]);\n  const [layerName, setLayerName] = useState('');\n  const [layerEntries, setLayerEntries] = useState<TypeListOfLayerEntryConfig>([]);\n\n  const sxClasses = {\n    buttonGroup: {\n      paddingTop: 12,\n      gap: 6,\n    },\n  };\n\n  const isMultiple = () => layerType === ESRI_DYNAMIC;\n\n  /**\n   * List of layer types and labels\n   */\n  const layerOptions = [\n    [ESRI_DYNAMIC, 'ESRI Dynamic Service'],\n    [ESRI_FEATURE, 'ESRI Feature Service'],\n    [GEOJSON, 'GeoJSON'],\n    [WMS, 'OGC Web Map Service (WMS)'],\n    [WFS, 'OGC Web Feature Service (WFS)'],\n    [OGC_FEATURE, 'OGC API Features'],\n    [XYZ_TILES, 'XYZ Raster Tiles'],\n    [GEOCORE, 'GeoCore'],\n  ];\n\n  /**\n   * Returns the appropriate error config for ESRI layer types\n   *\n   * @param type one of esriDynamic or esriFeature\n   * @returns {EsriOptions} an error configuration object for populating dialogues\n   */\n  const esriOptions = (type: string): EsriOptions => {\n    switch (type) {\n      case ESRI_DYNAMIC:\n        return { err: 'ESRI Map', capability: 'Map' };\n      case ESRI_FEATURE:\n        return { err: 'ESRI Feature', capability: 'Query' };\n      default:\n        return { err: '', capability: '' };\n    }\n  };\n\n  /**\n   * Emits an error dialogue when a text field is empty\n   *\n   * @param textField label for the TextField input that cannot be empty\n   */\n  const emitErrorEmpty = (textField: string) => {\n    api.event.emit(\n      snackbarMessagePayload(api.eventNames.SNACKBAR.EVENT_SNACKBAR_OPEN, mapId, {\n        type: 'string',\n        value: `${textField} cannot be empty`,\n      })\n    );\n  };\n\n  /**\n   * Emits an error when the URL does not support the selected service type\n   *\n   * @param serviceName type of service provided by the URL\n   */\n  const emitErrorServer = (serviceName: string) => {\n    api.event.emit(\n      snackbarMessagePayload(api.eventNames.SNACKBAR.EVENT_SNACKBAR_OPEN, mapId, {\n        type: 'string',\n        value: `URL is not a valid ${serviceName} Server`,\n      })\n    );\n  };\n\n  /**\n   * Emits an error when a service does not support the current map projection\n   *\n   * @param serviceName type of service provided by the URL\n   * @param proj current map projection\n   */\n  const emitErrorProj = (serviceName: string, proj: string | undefined, supportedProj: TypeJsonArray | string[]) => {\n    api.event.emit(\n      snackbarMessagePayload(api.eventNames.SNACKBAR.EVENT_SNACKBAR_OPEN, mapId, {\n        type: 'string',\n        value: `${serviceName} does not support current map projection ${proj}, only ${supportedProj.join(', ')}`,\n      })\n    );\n  };\n\n  /**\n   * Using the layerURL state object, check whether URL is a valid WMS,\n   * and add either Name and Entry directly to state if a single layer,\n   * or a list of Names / Entries if multiple layer options exist.\n   *\n   * @returns {Promise<boolean>} True if layer passes validation\n   */\n  const wmsValidation = async (): Promise<boolean> => {\n    const proj = api.projection.projections[api.map(mapId).currentProjection].getCode();\n    let supportedProj: string[] = [];\n    try {\n      const wms = await api.geoUtilities.getWMSServiceMetadata(layerURL, '');\n      supportedProj = wms.Capability.Layer.CRS as string[];\n      if (!supportedProj.includes(proj)) throw new Error('proj');\n      const layers = (wms.Capability.Layer.Layer as TypeJsonArray).map((aLayer) => [aLayer.Name, aLayer.Title]);\n      if (layers.length === 1) {\n        setLayerName(layers[0][1] as string);\n        setLayerEntries([\n          {\n            layerId: layers[0][0] as string,\n          },\n        ]);\n      } else {\n        setLayerList(layers);\n      }\n    } catch (err) {\n      if ((err as Error).message === 'proj') {\n        emitErrorProj('WMS', proj, supportedProj);\n      } else {\n        emitErrorServer('WMS');\n      }\n      return false;\n    }\n    return true;\n  };\n\n  /**\n   * Using the layerURL state object, check whether URL is a valid WFS,\n   * and add either Name and Entry directly to state if a single layer,\n   * or a list of Names / Entries if multiple layer options exist.\n   *\n   * @returns {Promise<boolean>} True if layer passes validation\n   */\n  const wfsValidation = async (): Promise<boolean> => {\n    try {\n      const wfs = await api.geoUtilities.getWFSServiceMetadata(layerURL);\n      const layers = (wfs.FeatureTypeList.FeatureType as TypeJsonArray).map((aFeatureType) => [\n        (aFeatureType.Name['#text'] as string).split(':')[1] as TypeJsonObject,\n        aFeatureType.Title['#text'],\n      ]);\n      if (layers.length === 1) {\n        setLayerName(layers[0][1] as string);\n        setLayerEntries([\n          {\n            layerId: layers[0][0] as string,\n          },\n        ]);\n      } else {\n        setLayerList(layers);\n      }\n    } catch (err) {\n      emitErrorServer('WFS');\n      return false;\n    }\n    return true;\n  };\n\n  /**\n   * Using the layerURL state object, check whether URL is a valid OGC API.\n   *\n   * @returns {Promise<boolean>} True if layer passes validation\n   */\n  const ogcFeatureValidation = async (): Promise<boolean> => {\n    const keys = ['collections', 'links'];\n    try {\n      const response = await fetch(`${layerURL}/collections?f=json`);\n      const json = await response.json();\n      const isValid = keys.every((key) => Object.keys(json).includes(key));\n      if (!isValid) throw new Error('err');\n      const layers = (json.collections as TypeJsonArray).map((aFeatureType) => [aFeatureType.id, aFeatureType.title]);\n      if (layers.length === 1) {\n        setLayerName(layers[0][1] as string);\n        setLayerEntries([\n          {\n            layerId: layers[0][0] as string,\n          },\n        ]);\n      } else {\n        setLayerList(layers);\n      }\n    } catch (err) {\n      emitErrorServer('OGC API Feature');\n      return false;\n    }\n    return true;\n  };\n\n  /**\n   * Using the layerURL state object, check whether URL is a valid Geocore UUID.\n   *\n   * @returns {Promise<boolean>} True if layer passes validation\n   */\n  const geocoreValidation = async (): Promise<boolean> => {\n    try {\n      const isValid = layerURL.indexOf('/') === -1 && layerURL.replaceAll('-', '').length === 32;\n      if (!isValid) throw new Error('err');\n      setLayerName('');\n      setLayerEntries([\n        {\n          layerId: layerURL,\n        },\n      ]);\n    } catch (err) {\n      emitErrorServer('GeoCore UUID');\n      return false;\n    }\n    return true;\n  };\n\n  /**\n   * Using the layerURL state object, check whether URL is a valid ESRI Server,\n   * and add either Name and Entry directly to state if a single layer,\n   * or a list of Names / Entries if multiple layer options exist.\n   *\n   * @returns {Promise<boolean>} True if layer passes validation\n   */\n  const esriValidation = async (type: string): Promise<boolean> => {\n    try {\n      const esri = await api.geoUtilities.getESRIServiceMetadata(layerURL);\n      if ((esri.capabilities as string).includes(esriOptions(type).capability)) {\n        if ('layers' in esri) {\n          const layers = (esri.layers as TypeJsonArray).map((aLayer) => [aLayer.id, aLayer.name]);\n          if (layers.length === 1) {\n            setLayerName(layers[0][1] as string);\n            setLayerEntries([\n              {\n                layerId: layers[0][0] as string,\n              },\n            ]);\n          } else {\n            setLayerList(layers);\n          }\n        } else {\n          setLayerName(esri.name as string);\n          setLayerEntries([\n            {\n              layerId: esri.id as string,\n            },\n          ]);\n        }\n      } else {\n        throw new Error('err');\n      }\n    } catch (err) {\n      emitErrorServer(esriOptions(type).err);\n      return false;\n    }\n    return true;\n  };\n\n  /**\n   * Using the layerURL state object, check whether URL is a valid XYZ Server.\n   *\n   * @returns {boolean} True if layer passes validation\n   */\n  const xyzValidation = (): boolean => {\n    const proj = api.projection.projections[api.map(mapId).currentProjection].getCode();\n    const tiles = ['{x}', '{y}', '{z}'];\n    for (let i = 0; i < tiles.length; i += 1) {\n      if (!layerURL.includes(tiles[i])) {\n        emitErrorServer('XYZ Tile');\n        return false;\n      }\n    }\n    if (proj !== 'EPSG:3857') {\n      emitErrorProj('XYZ Tiles', proj, ['EPSG:3857']);\n      return false;\n    }\n    const dataAccessPath = layerURL;\n    setLayerName('');\n    setLayerEntries([\n      {\n        layerId: layerURL,\n        source: {\n          dataAccessPath: {\n            en: dataAccessPath,\n            fr: dataAccessPath,\n          },\n        },\n      },\n    ]);\n    return true;\n  };\n\n  /**\n   * Using the layerURL state object, check whether URL is a valid GeoJSON.\n   *\n   * @returns {Promise<boolean>} True if layer passes validation\n   */\n  const geoJSONValidation = async (): Promise<boolean> => {\n    try {\n      const response = await fetch(layerURL);\n      const json = await response.json();\n      if (!['FeatureCollection', 'Feature'].includes(json.type)) {\n        throw new Error('err');\n      }\n      const layerId = layerURL.split('/').pop() as string;\n      const dataAccessPath = layerURL.replace(layerId, '');\n      setLayerName(layerId);\n      setLayerEntries([\n        {\n          layerId,\n          source: {\n            dataAccessPath: {\n              en: dataAccessPath,\n              fr: dataAccessPath,\n            },\n          },\n        },\n      ]);\n    } catch (err) {\n      emitErrorServer('GeoJSON');\n      return false;\n    }\n    return true;\n  };\n\n  /**\n   * Attempt to determine the layer type based on the URL format\n   */\n  const bestGuessLayerType = () => {\n    const layerTokens = layerURL.toUpperCase().split('/');\n    const layerId = parseInt(layerTokens[layerTokens.length - 1], 10);\n    if (layerURL.toUpperCase().endsWith('MAPSERVER') || layerURL.toUpperCase().endsWith('MAPSERVER/')) {\n      setLayerType(ESRI_DYNAMIC);\n    } else if (\n      layerURL.toUpperCase().indexOf('FEATURESERVER') !== -1 ||\n      (layerURL.toUpperCase().indexOf('MAPSERVER') !== -1 && !Number.isNaN(layerId))\n    ) {\n      setLayerType(ESRI_FEATURE);\n    } else if (layerTokens.indexOf('WFS') !== -1) {\n      setLayerType(WFS);\n    } else if (layerURL.toUpperCase().endsWith('.JSON') || layerURL.toUpperCase().endsWith('.GEOJSON')) {\n      setLayerType(GEOJSON);\n    } else if (layerURL.toUpperCase().indexOf('{Z}/{X}/{Y}') !== -1 || layerURL.toUpperCase().indexOf('{Z}/{Y}/{X}') !== -1) {\n      setLayerType(XYZ_TILES);\n    } else if (layerURL.indexOf('/') === -1 && layerURL.replaceAll('-', '').length === 32) {\n      setLayerType(GEOCORE);\n    }\n  };\n\n  /**\n   * Handle the behavior of the 'Continue' button in the Stepper UI\n   */\n  const handleStep1 = () => {\n    let valid = true;\n    if (layerURL.trim() === '') {\n      valid = false;\n      emitErrorEmpty('URL');\n    }\n    if (valid) {\n      bestGuessLayerType();\n      setActiveStep(1);\n    }\n  };\n\n  /**\n   * Handle the behavior of the 'Continue' button in the Stepper UI\n   */\n  const handleStep2 = async () => {\n    let valid = true;\n    if (layerType === undefined) {\n      valid = false;\n      emitErrorEmpty('Service Type');\n    } else if (layerType === WMS) valid = await wmsValidation();\n    else if (layerType === WFS) valid = await wfsValidation();\n    else if (layerType === OGC_FEATURE) valid = await ogcFeatureValidation();\n    else if (layerType === XYZ_TILES) valid = xyzValidation();\n    else if (layerType === ESRI_DYNAMIC) valid = await esriValidation(ESRI_DYNAMIC);\n    else if (layerType === ESRI_FEATURE) valid = await esriValidation(ESRI_FEATURE);\n    else if (layerType === GEOJSON) valid = await geoJSONValidation();\n    else if (layerType === GEOCORE) valid = await geocoreValidation();\n    if (valid) setActiveStep(2);\n  };\n\n  /**\n   * Handle the behavior of the 'Finish' button in the Stepper UI\n   */\n  const handleStep3 = () => {\n    let valid = true;\n    if (layerEntries.length === 0) {\n      valid = false;\n      emitErrorEmpty('Layer');\n    }\n    if (valid) setActiveStep(3);\n  };\n\n  /**\n   * Handle the behavior of the 'Finish' button in the Stepper UI\n   */\n  const handleStepLast = () => {\n    let valid = true;\n    const name = layerName;\n    let url = layerURL;\n    if (layerType === ESRI_DYNAMIC || layerType === ESRI_FEATURE) {\n      url = api.geoUtilities.getMapServerUrl(layerURL);\n    }\n\n    if (layerName === '') {\n      valid = false;\n      emitErrorEmpty(isMultiple() ? 'Name' : 'Layer');\n    }\n    const layerConfig: TypeGeoviewLayerConfig = {\n      geoviewLayerId: api.generateId(),\n      geoviewLayerName: {\n        en: name,\n        fr: name,\n      },\n      geoviewLayerType: layerType as TypeGeoviewLayerType,\n      metadataAccessPath: {\n        en: url,\n        fr: url,\n      },\n      listOfLayerEntryConfig: layerEntries as TypeListOfLayerEntryConfig,\n    };\n\n    if (layerType === GEOJSON || layerType === XYZ_TILES) {\n      // TODO probably want an option to add metadata if geojson\n      // need to clear our metadata path or it will give errors trying to find it\n      layerConfig.metadataAccessPath = {\n        en: '',\n        fr: '',\n      };\n    }\n    if (layerType === GEOCORE) {\n      delete layerConfig.metadataAccessPath;\n    }\n    if (valid) {\n      api.map(mapId).layer.addGeoviewLayer(layerConfig);\n      setAddLayerVisible(false);\n    }\n  };\n\n  /**\n   * Handle the behavior of the 'Back' button in the Stepper UI\n   */\n  const handleBack = () => {\n    setActiveStep((prevActiveStep: number) => prevActiveStep - 1);\n  };\n\n  /**\n   * Set layer URL from form input\n   *\n   * @param e TextField event\n   */\n  const handleInput = (event: Event) => {\n    setLayerURL(event.target.value);\n    setLayerType('');\n    setLayerList([]);\n    setLayerName('');\n    setLayerEntries([]);\n  };\n\n  /**\n   * Set layerType from form input\n   *\n   * @param {SelectChangeEvent} event TextField event\n   */\n  const handleSelectType = (event: SelectChangeEvent<unknown>) => {\n    setLayerType(event.target.value as TypeGeoviewLayerType);\n    setLayerList([]);\n    setLayerName('');\n    setLayerEntries([]);\n  };\n\n  /**\n   * Set the currently selected layer from a list\n   *\n   * @param event Select event\n   * @param newValue value/label pairs of select options\n   */\n  const handleSelectLayer = (event: Event, newValue: string[]) => {\n    if (isMultiple()) {\n      setLayerEntries(\n        newValue.map((x: string) => {\n          if (layerType === ESRI_DYNAMIC) {\n            return { layerId: x[0] } as TypeEsriDynamicLayerEntryConfig;\n          }\n\n          return { layerId: x[0] as string } as TypeWmsLayerEntryConfig;\n        })\n      );\n      setLayerName(newValue.map((x) => x[1]).join(', '));\n    } else {\n      if (layerType === ESRI_DYNAMIC) {\n        setLayerEntries([{ layerId: newValue[0] } as TypeEsriDynamicLayerEntryConfig]);\n      } else {\n        setLayerEntries([{ layerId: newValue[0] } as TypeWmsLayerEntryConfig]);\n      }\n      setLayerName(newValue[1]);\n    }\n  };\n\n  /**\n   * Set the layer name from form input\n   *\n   * @param e TextField event\n   */\n  const handleNameLayer = (event: Event) => {\n    setLayerName(event.target.value);\n  };\n\n  /**\n   * Creates a set of Continue / Back buttons\n   *\n   * @param param0 specify if button is first or last in the list\n   * @returns {JSX.Element} React component\n   */\n  // eslint-disable-next-line react/no-unstable-nested-components\n  function NavButtons({ isFirst = false, isLast = false, handleNext }: ButtonPropsLayerPanel): JSX.Element {\n    return (\n      <ButtonGroup sx={sxClasses.buttonGroup}>\n        <Button variant=\"contained\" type=\"text\" onClick={handleNext}>\n          {isLast ? 'Finish' : 'Continue'}\n        </Button>\n        {!isFirst && (\n          <Button variant=\"contained\" type=\"text\" onClick={handleBack}>\n            Back\n          </Button>\n        )}\n      </ButtonGroup>\n    );\n  }\n\n  return (\n    <Stepper\n      activeStep={activeStep}\n      orientation=\"vertical\"\n      steps={[\n        {\n          stepLabel: {\n            children: 'Enter URL / UUID',\n          },\n          stepContent: {\n            children: (\n              <>\n                <TextField sx={{ width: '100%' }} label=\"URL\" variant=\"standard\" value={layerURL} onChange={handleInput} />\n                <br />\n                <NavButtons isFirst handleNext={handleStep1} />\n              </>\n            ),\n          },\n        },\n        {\n          stepLabel: {\n            children: 'Select format',\n          },\n          stepContent: {\n            children: (\n              <>\n                <Select\n                  fullWidth\n                  labelId=\"service-type-label\"\n                  value={layerType}\n                  onChange={handleSelectType}\n                  label=\"Service Type\"\n                  inputLabel={{\n                    id: 'service-type-label',\n                  }}\n                  menuItems={layerOptions.map(([value, label]) => ({\n                    key: value,\n                    item: {\n                      value,\n                      children: label,\n                    },\n                  }))}\n                />\n                <NavButtons handleNext={handleStep2} />\n              </>\n            ),\n          },\n        },\n        {\n          stepLabel: {\n            children: 'Configure layer',\n          },\n          stepContent: {\n            children: (\n              <>\n                {layerList.length === 0 && <TextField label=\"Name\" variant=\"standard\" value={layerName} onChange={handleNameLayer} />}\n                {layerList.length > 1 && (\n                  <Autocomplete\n                    fullWidth\n                    multiple={isMultiple()}\n                    disableCloseOnSelect\n                    disableClearable={!isMultiple()}\n                    id=\"service-layer-label\"\n                    options={layerList}\n                    getOptionLabel={(option) => `${option[1]} (${option[0]})`}\n                    renderOption={(props, option) => <span {...props}>{option[1]}</span>}\n                    // value={\n                    //   layerType === ESRI_DYNAMIC\n                    //     ? layerEntries.map((entry) => {\n                    //         return (entry as TypeDynamicLayerEntry).index.toString();\n                    //       })\n                    //     : layerEntries.map((entry) => {\n                    //         return (entry as TypeOgcLayerEntry).id;\n                    //       })\n                    // }\n                    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n                    onChange={handleSelectLayer as any}\n                    renderInput={(params) => <TextField {...params} label=\"Select Layer\" />}\n                  />\n                )}\n                <br />\n                <NavButtons isLast={!isMultiple()} handleNext={isMultiple() ? handleStep3 : handleStepLast} />\n              </>\n            ),\n          },\n        },\n        isMultiple()\n          ? {\n              stepLabel: {\n                children: 'Enter Name',\n              },\n              stepContent: {\n                children: (\n                  <>\n                    <TextField sx={{ width: '100%' }} label=\"Name\" variant=\"standard\" value={layerName} onChange={handleNameLayer} />\n                    <br />\n                    <NavButtons isLast handleNext={handleStepLast} />\n                  </>\n                ),\n              },\n            }\n          : null,\n      ]}\n    />\n  );\n}\n\nexport default LayerStepper;\n","import { toJsonObject, TypeJsonObject, TypeWindow, TypeButtonPanel } from 'geoview-core';\n\nimport LayerStepper from './layer-stepper';\n\ntype TypePanelContentProps = {\n  buttonPanel: TypeButtonPanel;\n  mapId: string;\n};\n\nconst w = window as TypeWindow;\n\n/**\n * A react component that displays the details panel content\n *\n * @param {TypePanelContentProps} props the properties of the pane content\n * @returns {JSX.Element} A React JSX Element with the details panel\n */\nfunction PanelContent(props: TypePanelContentProps): JSX.Element {\n  const { mapId, buttonPanel } = props;\n\n  const { cgpv } = w;\n  const { api, react, ui } = cgpv;\n  const { useState, useEffect } = react;\n  const [addLayerVisible, setAddLayerVisible] = useState(false);\n  const [mapLayers, setMapLayers] = useState({});\n  const { Typography, IconButton, AddIcon, Box } = ui.elements;\n\n  const { displayLanguage } = api.map(mapId!);\n\n  const translations: TypeJsonObject = toJsonObject({\n    en: {\n      addLayer: 'Add Layer',\n    },\n    fr: {\n      addLayer: 'Ajouter Couche',\n    },\n  });\n\n  const sxClasses = {\n    mainContainer: {\n      display: 'flex',\n      flexDirection: 'column',\n      height: 'inherit',\n    },\n    topControls: {\n      display: 'flex',\n      flexDirection: 'row',\n      justifyContent: 'space-between',\n    },\n    addLayerSection: {\n      display: 'flex',\n      alignItems: 'center',\n      marginTop: 'auto',\n      justifyContent: 'end',\n    },\n  };\n\n  const onClick = () => setAddLayerVisible((state: boolean) => !state);\n\n  const Legend = api.map(mapId!).legend.createLegend();\n\n  useEffect(() => {\n    setMapLayers(() => ({ ...api.map(mapId!).layer.geoviewLayers }));\n    api.event.on(\n      api.eventNames.LAYER.EVENT_LAYER_ADDED,\n      () =>\n        setMapLayers(() => ({\n          ...api.map(mapId!).layer.geoviewLayers,\n        })),\n      mapId\n    );\n    api.event.on(\n      api.eventNames.LAYER.EVENT_REMOVE_LAYER,\n      () =>\n        setMapLayers(() => ({\n          ...api.map(mapId!).layer.geoviewLayers,\n        })),\n      mapId\n    );\n    api.event.on(\n      api.eventNames.PANEL.EVENT_PANEL_CLOSE,\n      () => {\n        setAddLayerVisible(false);\n      },\n      mapId,\n      buttonPanel.buttonPanelId\n    );\n\n    return () => {\n      api.event.off(api.eventNames.LAYER.EVENT_LAYER_ADDED, mapId);\n      api.event.off(api.eventNames.LAYER.EVENT_REMOVE_LAYER, mapId);\n      api.event.off(api.eventNames.PANEL.EVENT_PANEL_CLOSE, mapId, buttonPanel.buttonPanelId);\n    };\n  }, [api, buttonPanel.buttonPanelId, mapId]);\n\n  return (\n    <Box sx={sxClasses.mainContainer}>\n      {addLayerVisible && <LayerStepper mapId={mapId!} setAddLayerVisible={setAddLayerVisible} />}\n      {/* <Box sx={sxClasses.topControls} style={{ display: addLayerVisible ? 'none' : 'flex' }}>\n        <div>Expand All</div>\n        <div>Hide All</div>\n      </Box> */}\n      <div style={{ display: addLayerVisible ? 'none' : 'block' }}>\n        <Legend />\n      </div>\n      <Box sx={sxClasses.addLayerSection} onClick={onClick}>\n        <Typography>{translations[displayLanguage].addLayer}</Typography>\n        <IconButton>\n          <AddIcon />\n        </IconButton>\n      </Box>\n    </Box>\n  );\n}\n\nexport default PanelContent;\n","/* eslint-disable @typescript-eslint/explicit-module-boundary-types */\nimport {\n  Cast,\n  AbstractPlugin,\n  toJsonObject,\n  TypeJsonObject,\n  TypeWindow,\n  TypePluginOptions,\n  TypeButtonPanel,\n  TypeIconButtonProps,\n  TypePanelProps,\n  AnySchemaObject,\n} from 'geoview-core';\nimport PanelContent from './panel-content';\nimport schema from '../schema.json';\nimport defaultConfig from '../default-config-layers-panel.json';\n\nconst w = window as TypeWindow;\n\n/**\n * Create a class for the plugin instance\n */\nclass LayersPanelPlugin extends AbstractPlugin {\n  // store the created button panel object\n  buttonPanel: TypeButtonPanel | null;\n\n  constructor(pluginId: string, props: TypePluginOptions) {\n    super(pluginId, props);\n    this.buttonPanel = null;\n  }\n\n  /**\n   * Return the schema that is defined for this package\n   *\n   * @returns {AnySchemaObject} returns the schema for this package\n   */\n  schema = (): AnySchemaObject => schema;\n\n  /**\n   * Return the default config for this package\n   *\n   * @returns {TypeJsonObject} the default config\n   */\n  defaultConfig = (): TypeJsonObject => toJsonObject(defaultConfig);\n\n  /**\n   * translations object to inject to the viewer translations\n   */\n  translations: TypeJsonObject = toJsonObject({\n    en: {\n      layersPanel: 'Layers',\n    },\n    fr: {\n      layersPanel: 'Couches',\n    },\n  });\n\n  /**\n   * Added function called after the plugin has been initialized\n   */\n  added = (): void => {\n    const { mapId } = this.pluginProps;\n\n    // access the cgpv object from the window object\n    const { cgpv } = w;\n\n    // access the api calls\n    const { api, ui } = cgpv;\n    const { LayersOutlinedIcon } = ui.elements;\n    const { displayLanguage } = api.map(mapId);\n\n    let panelStatus = false;\n\n    panelStatus = this.configObj?.isOpen?.large as boolean;\n\n    // button props\n    const button: TypeIconButtonProps = {\n      id: 'layersPanelButton',\n      tooltip: this.translations[displayLanguage].layersPanel as string,\n      tooltipPlacement: 'right',\n      children: <LayersOutlinedIcon />,\n      visible: true,\n    };\n\n    // panel props\n    const panel: TypePanelProps = {\n      title: this.translations[displayLanguage].layersPanel,\n      icon: '<i class=\"material-icons\">layers</i>',\n      width: 200,\n      status: panelStatus,\n    };\n\n    // create a new button panel on the app-bar\n    this.buttonPanel = api.map(mapId).appBarButtons.createAppbarPanel(button, panel, null);\n\n    // set panel content\n    this.buttonPanel?.panel?.changeContent(<PanelContent buttonPanel={this.buttonPanel} mapId={mapId} />);\n  };\n\n  /**\n   * Function called when the plugin is removed, used for clean up\n   */\n  removed(): void {\n    const { mapId } = this.pluginProps;\n\n    // access the cgpv object from the window object\n    const { cgpv } = w;\n\n    // access the api calls\n    const { api } = cgpv;\n\n    if (this.buttonPanel) {\n      api.map(mapId).appBarButtons.removeAppbarPanel(this.buttonPanel.buttonPanelId);\n    }\n  }\n}\n\nexport default LayersPanelPlugin;\n\nw.plugins = w.plugins || {};\nw.plugins['layers-panel'] = Cast<AbstractPlugin>(LayersPanelPlugin);\n"],"names":["w","window","mapId","setAddLayerVisible","cgpv","api","react","ui","layerTypes","ESRI_DYNAMIC","ESRI_FEATURE","GEOJSON","WMS","WFS","OGC_FEATURE","XYZ_TILES","GEOCORE","useState","elements","Select","Stepper","TextField","Button","ButtonGroup","Autocomplete","activeStep","setActiveStep","layerURL","setLayerURL","layerType","setLayerType","layerList","setLayerList","layerName","setLayerName","layerEntries","setLayerEntries","sxClasses","buttonGroup","paddingTop","gap","isMultiple","layerOptions","esriOptions","type","err","capability","emitErrorEmpty","textField","event","emit","snackbarMessagePayload","eventNames","SNACKBAR","EVENT_SNACKBAR_OPEN","value","emitErrorServer","serviceName","emitErrorProj","proj","supportedProj","join","wmsValidation","projection","projections","map","currentProjection","getCode","geoUtilities","getWMSServiceMetadata","wms","Capability","Layer","CRS","includes","Error","layers","aLayer","Name","Title","length","layerId","message","wfsValidation","getWFSServiceMetadata","wfs","FeatureTypeList","FeatureType","aFeatureType","split","ogcFeatureValidation","keys","fetch","response","json","every","key","Object","collections","id","title","geocoreValidation","indexOf","replaceAll","esriValidation","getESRIServiceMetadata","esri","capabilities","name","xyzValidation","tiles","i","dataAccessPath","source","en","fr","geoJSONValidation","pop","replace","handleStep2","valid","undefined","handleStepLast","url","getMapServerUrl","layerConfig","geoviewLayerId","generateId","geoviewLayerName","geoviewLayerType","metadataAccessPath","listOfLayerEntryConfig","layer","addGeoviewLayer","handleBack","prevActiveStep","handleNameLayer","target","NavButtons","isFirst","isLast","handleNext","sx","variant","onClick","orientation","steps","stepLabel","children","stepContent","width","label","onChange","layerTokens","trim","toUpperCase","parseInt","endsWith","Number","isNaN","fullWidth","labelId","inputLabel","menuItems","item","multiple","disableCloseOnSelect","disableClearable","options","getOptionLabel","option","renderOption","props","newValue","x","renderInput","params","buttonPanel","useEffect","addLayerVisible","setMapLayers","Typography","IconButton","AddIcon","Box","displayLanguage","translations","toJsonObject","addLayer","mainContainer","display","flexDirection","height","topControls","justifyContent","addLayerSection","alignItems","marginTop","Legend","legend","createLegend","geoviewLayers","on","LAYER","EVENT_LAYER_ADDED","EVENT_REMOVE_LAYER","PANEL","EVENT_PANEL_CLOSE","buttonPanelId","off","style","state","LayersPanelPlugin","pluginId","schema","defaultConfig","layersPanel","panelStatus","pluginProps","LayersOutlinedIcon","configObj","isOpen","large","button","tooltip","tooltipPlacement","visible","panel","icon","status","appBarButtons","createAppbarPanel","changeContent","this","removeAppbarPanel","AbstractPlugin","plugins","Cast"],"sourceRoot":""}